Analizzando il file: results/medium/simulated_granuloma_medium.rds 
Numero di tipi cellulari letto dal file RDS: 5 
Creazione della matrice di espressione...
Creazione dell'oggetto Seurat...
Generazione dei plot diagnostici pre-filtering...
Warning: Default search for "data" layer in "RNA" assay yielded no results; utilizing "counts" layer instead.
Warning: Default search for "data" layer in "RNA" assay yielded no results; utilizing "counts" layer instead.
Filtraggio dei geni a bassa espressione...
Numero di geni dopo il filtraggio: 100
Numero di cellule dopo il filtraggio: 30000
Generazione dei plot diagnostici post-filtering...
Warning: Default search for "data" layer in "RNA" assay yielded no results; utilizing "counts" layer instead.
Warning: Default search for "data" layer in "RNA" assay yielded no results; utilizing "counts" layer instead.
Normalizzazione dei dati con SCTransform...
Esecuzione della PCA...
PC_ 1 
Positive:  Feature34, Feature32, Feature31, Feature29, Feature33, Feature35, Feature30, Feature23, Feature28, Feature24 
	   Feature27, Feature25, Feature41, Feature60, Feature45, Feature26, Feature22, Feature43, Feature94, Feature39 
	   Feature74, Feature53, Feature97, Feature87, Feature86, Feature49, Feature84, Feature82, Feature63, Feature38 
Negative:  Feature17, Feature15, Feature18, Feature16, Feature20, Feature19, Feature3, Feature5, Feature2, Feature4 
	   Feature7, Feature21, Feature1, Feature6, Feature12, Feature14, Feature10, Feature8, Feature11, Feature13 
	   Feature9, Feature69, Feature90, Feature93, Feature57, Feature55, Feature47, Feature88, Feature76, Feature64 
PC_ 2 
Positive:  Feature3, Feature5, Feature2, Feature4, Feature7, Feature1, Feature6, Feature30, Feature93, Feature82 
	   Feature83, Feature37, Feature97, Feature26, Feature59, Feature22, Feature56, Feature76, Feature100, Feature90 
	   Feature62, Feature88, Feature44, Feature39, Feature60, Feature57, Feature91, Feature43, Feature49, Feature72 
Negative:  Feature17, Feature15, Feature18, Feature16, Feature19, Feature20, Feature21, Feature14, Feature10, Feature8 
	   Feature12, Feature11, Feature27, Feature25, Feature23, Feature28, Feature34, Feature24, Feature31, Feature73 
	   Feature29, Feature36, Feature41, Feature33, Feature38, Feature94, Feature81, Feature48, Feature78, Feature75 
PC_ 3 
Positive:  Feature34, Feature32, Feature31, Feature35, Feature33, Feature3, Feature29, Feature17, Feature5, Feature7 
	   Feature20, Feature2, Feature15, Feature19, Feature18, Feature16, Feature4, Feature14, Feature12, Feature8 
	   Feature10, Feature11, Feature30, Feature46, Feature87, Feature40, Feature64, Feature21, Feature57, Feature1 
Negative:  Feature27, Feature28, Feature25, Feature23, Feature24, Feature22, Feature26, Feature93, Feature83, Feature66 
	   Feature86, Feature71, Feature100, Feature70, Feature44, Feature55, Feature65, Feature42, Feature39, Feature80 
	   Feature62, Feature99, Feature97, Feature76, Feature43, Feature67, Feature90, Feature56, Feature51, Feature79 
PC_ 4 
Positive:  Feature15, Feature16, Feature18, Feature19, Feature20, Feature17, Feature3, Feature7, Feature5, Feature2 
	   Feature4, Feature29, Feature21, Feature31, Feature35, Feature32, Feature33, Feature27, Feature1, Feature23 
	   Feature34, Feature6, Feature24, Feature82, Feature28, Feature90, Feature30, Feature48, Feature37, Feature87 
Negative:  Feature12, Feature14, Feature10, Feature8, Feature11, Feature13, Feature9, Feature53, Feature94, Feature45 
	   Feature64, Feature44, Feature84, Feature99, Feature54, Feature38, Feature43, Feature49, Feature97, Feature62 
	   Feature81, Feature67, Feature69, Feature85, Feature95, Feature89, Feature77, Feature65, Feature59, Feature92 
PC_ 5 
Positive:  Feature25, Feature28, Feature7, Feature27, Feature3, Feature45, Feature63, Feature5, Feature59, Feature2 
	   Feature54, Feature75, Feature76, Feature71, Feature23, Feature87, Feature66, Feature91, Feature62, Feature68 
	   Feature24, Feature55, Feature48, Feature36, Feature74, Feature46, Feature4, Feature58, Feature80, Feature47 
Negative:  Feature30, Feature21, Feature1, Feature6, Feature9, Feature13, Feature32, Feature22, Feature26, Feature29 
	   Feature20, Feature16, Feature83, Feature93, Feature33, Feature17, Feature31, Feature19, Feature15, Feature35 
	   Feature18, Feature11, Feature34, Feature14, Feature10, Feature12, Feature8, Feature50, Feature43, Feature60 
PCA completata.
PC_ 1 
Positive:  Feature34, Feature32, Feature31, Feature29, Feature33 
Negative:  Feature17, Feature15, Feature18, Feature16, Feature20 
PC_ 2 
Positive:  Feature3, Feature5, Feature2, Feature4, Feature7 
Negative:  Feature17, Feature15, Feature18, Feature16, Feature19 
PC_ 3 
Positive:  Feature34, Feature32, Feature31, Feature35, Feature33 
Negative:  Feature27, Feature28, Feature25, Feature23, Feature24 
PC_ 4 
Positive:  Feature15, Feature16, Feature18, Feature19, Feature20 
Negative:  Feature12, Feature14, Feature10, Feature8, Feature11 
PC_ 5 
Positive:  Feature25, Feature28, Feature7, Feature27, Feature3 
Negative:  Feature30, Feature21, Feature1, Feature6, Feature9 
Rinomina dei cluster reali basati sulla dimensione...
Esecuzione del clustering con Seurat...
Clustering con Seurat completato. Numero di cluster identificati: 5 
Rinomina dei cluster Seurat basati sulla dimensione...
Esecuzione di UMAP con Seurat...
Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session
19:23:56 UMAP embedding parameters a = 1.121 b = 1.057
19:23:56 Read 30000 rows and found 30 numeric columns
19:23:56 Using Annoy for neighbor search, n_neighbors = 5
19:23:56 Building Annoy index with metric = cosine, n_trees = 50
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
19:23:59 Writing NN index file to temp file /tmp/RtmpMEWzg4/file2aa64104f3081
19:23:59 Searching Annoy index using 3 threads, search_k = 500
19:24:00 Annoy recall = 100%
19:24:00 Commencing smooth kNN distance calibration using 3 threads with target n_neighbors = 5
19:24:01 Initializing from normalized Laplacian + noise (using RSpectra)
19:24:01 Commencing optimization for 200 epochs, with 200292 positive edges
Using method 'umap'
0%   10   20   30   40   50   60   70   80   90   100%
[----|----|----|----|----|----|----|----|----|----|
**************************************************|
19:24:06 Optimization finished
Calcolo del Silhouette Score...
  cluster size ave.sil.width
1       1 7702          0.12
2       2 7107          0.43
3       3 6391          0.46
4       4 5999          0.40
5       5 2801          0.46
Creazione del plot spaziale dei cluster Seurat...
Creazione del plot delle proporzioni dei cluster Seurat...
Applicazione di HDBSCAN sui dati UMAP...
Risultati HDBSCAN:

    0     1     2     3     4     5     6     7     8     9    10    11    12 
15931    11    32    11    10    15    10    10    10    11    21    10    10 
   13    14    15    16    17    18    19    20    21    22    23    24    25 
   82    12    40    13    10    27    23    21    11    10    14    11    16 
   26    27    28    29    30    31    32    33    34    35    36    37    38 
   11    17    10    35    22    27   218    15    12    11    19    11    48 
   39    40    41    42    43    44    45    46    47    48    49    50    51 
   18    17   228    47    16    11    28    24    16    10    60    17    12 
   52    53    54    55    56    57    58    59    60    61    62    63    64 
   28    11    41    38    35    21    69    61    13    17    15    19    24 
   65    66    67    68    69    70    71    72    73    74    75    76    77 
   12   383    21    17    21    12    46    10    14    63    34    12    13 
   78    79    80    81    82    83    84    85    86    87    88    89    90 
   12    22    16    11    26   305    13  2406    28    24    17    31    20 
   91    92    93    94    95    96    97    98    99   100   101   102   103 
   11    11    13    37    94    17    11    10    14    17    10    27    19 
  104   105   106   107   108   109   110   111   112   113   114   115   116 
   14   351    30    34    15    22    10    11   274    14    12    16    32 
  117   118   119   120   121   122   123   124   125   126   127   128   129 
   46    11    47    10    19    13    44    19    17    17    40    11    19 
  130   131   132   133   134   135   136   137   138   139   140   141   142 
   22    15    11    31   130    29    33   260    41    22    32    13    13 
  143   144   145   146   147   148   149   150   151   152   153   154   155 
   23   181    13    34    11    22    38    15    25    11    21    13   111 
  156   157   158   159   160   161   162   163   164   165   166   167   168 
   15    18    34    17    16    28    26    24    19    44    20    23    18 
  169   170   171   172   173   174   175   176   177   178   179   180   181 
   12    13    19    11    20    17    17    12    13    10    73    22    11 
  182   183   184   185   186   187   188   189   190   191   192   193   194 
   17    21    13   431    12    19    32    22    19    84    10    10    19 
  195   196   197   198   199   200   201   202   203   204   205   206   207 
   10    61    18    11    10    84    19    32    27    15    18    17    43 
  208   209   210   211   212   213   214   215   216   217   218   219   220 
   11    35    28    16    10    19    16    49    31    23    30    25    18 
  221   222   223   224   225   226   227   228   229   230   231   232   233 
   46    44    43    40    93    22    22    15   145    36    46    23    11 
  234   235   236   237   238   239   240   241   242   243   244   245   246 
   18    38    43    31    14    36    39    19    14    27    33    13    17 
  247   248   249   250   251   252   253   254   255   256   257   258   259 
   72    25    11    34    44    15    33    30    17    44    12    11    14 
  260   261   262   263   264   265   266   267   268   269   270   271   272 
   67    18    40   413    11    19    32    14    11    11    23   206    13 
  273   274   275   276   277   278   279   280   281   282   283   284   285 
   31    17    79    18    27    14    40    45    13   622    16    10    11 
  286   287   288   289   290   291   292   293   294   295   296   297   298 
   11    10    11    30    17    10    32    20   278    36    10    37    10 
  299   300   301   302   303   304   305   306   307   308   309   310   311 
   34    10    43    28    15    19    20    13    12    41    21    48    45 
  312   313   314   315 
   23    27    40    69 
Rinomina dei cluster HDBSCAN basati sulla dimensione...
Creazione delle tabelle di contingenza...
Tabella di contingenza (intensity_cluster vs Renamed HDBSCAN):
         
          cells_a cells_b cells_c cells_d cells_e noise
  cells_a    4447     175     574      11     383  2596
  cells_b     377    1720       8       2       2   149
  cells_c    3896     273      15      10      10  2892
  cells_d    2933     106       7     385       7  1594
  cells_e    4278     132      18      23      11  2966
Tabella di contingenza (intensity_cluster vs Renamed Seurat):
         
          cells_a cells_b cells_c cells_d cells_e
  cells_a    1003    6511     242     190     240
  cells_b     233      85      31      40    1869
  cells_c     922     191     201    5386     396
  cells_d    4446     129     136     203     118
  cells_e    1098     191    5781     180     178
Salvataggio dell'oggetto Seurat con i cluster rinominati...
Analisi completata e oggetto Seurat salvato in results/medium/seurat_hdbscan_combined_medium.rds 
Calcolo delle metriche di performance per i cluster Seurat e HDBSCAN...

Calcolo di True Positives (TP), False Positives (FP), False Negatives (FN) e Precision per Seurat:

Tabella di contingenza per Seurat:
            predicted_factors
true_factors cells_a cells_b cells_c cells_d cells_e
     cells_a    1003    6511     242     190     240
     cells_b    1098     191    5781     180     178
     cells_c     922     191     201    5386     396
     cells_d    4446     129     136     203     118
     cells_e     233      85      31      40    1869

Calcolo di True Positives (TP), False Positives (FP) e False Negatives (FN) e Precision per HDBSCAN:

Tabella di contingenza per HDBSCAN:
            predicted_factors
true_factors cells_a cells_b cells_c cells_d cells_e noise
     cells_a    4447     175     574      11     383  2596
     cells_b    4278     132      18      23      11  2966
     cells_c    3896     273      15      10      10  2892
     cells_d    2933     106       7     385       7  1594
     cells_e     377    1720       8       2       2   149
     noise         0       0       0       0       0     0

Metriche di Performance Combinate:
# A tibble: 13 × 6
   Method  Class   True_Positives False_Positives False_Negatives Precision
   <chr>   <chr>            <int>           <dbl>           <dbl>     <dbl>
 1 Seurat  cells_a           1003            6699            7183   0.130  
 2 Seurat  cells_b            191            6916            7237   0.0269 
 3 Seurat  cells_c            201            6190            6895   0.0315 
 4 Seurat  cells_d            203            5796            4829   0.0338 
 5 Seurat  cells_e           1869             932             389   0.667  
 6 Seurat  Total             3467           26533           26533   0.116  
 7 HDBSCAN cells_a           4447           11484            3739   0.279  
 8 HDBSCAN cells_b            132            2274            7296   0.0549 
 9 HDBSCAN cells_c             15             607            7081   0.0241 
10 HDBSCAN cells_d            385              46            4647   0.893  
11 HDBSCAN cells_e              2             411            2256   0.00484
12 HDBSCAN noise                0           10197               0   0      
13 HDBSCAN Total             4981           25019           25019   0.166  
Confronto completato e metriche salvate in results/medium/metrics_comparison_medium.csv 
# A tibble: 13 × 6
   Method  Class   True_Positives False_Positives False_Negatives Precision
   <chr>   <chr>            <int>           <dbl>           <dbl>     <dbl>
 1 Seurat  cells_a           1003            6699            7183   0.130  
 2 Seurat  cells_b            191            6916            7237   0.0269 
 3 Seurat  cells_c            201            6190            6895   0.0315 
 4 Seurat  cells_d            203            5796            4829   0.0338 
 5 Seurat  cells_e           1869             932             389   0.667  
 6 Seurat  Total             3467           26533           26533   0.116  
 7 HDBSCAN cells_a           4447           11484            3739   0.279  
 8 HDBSCAN cells_b            132            2274            7296   0.0549 
 9 HDBSCAN cells_c             15             607            7081   0.0241 
10 HDBSCAN cells_d            385              46            4647   0.893  
11 HDBSCAN cells_e              2             411            2256   0.00484
12 HDBSCAN noise                0           10197               0   0      
13 HDBSCAN Total             4981           25019           25019   0.166  
Warning messages:
1: The `slot` argument of `GetAssayData()` is deprecated as of SeuratObject 5.0.0.
ℹ Please use the `layer` argument instead. 
2: UNRELIABLE VALUE: One of the ‘future.apply’ iterations (‘future_lapply-1’) unexpectedly generated random numbers without declaring so. There is a risk that those random numbers are not statistically sound and the overall results might be invalid. To fix this, specify 'future.seed=TRUE'. This ensures that proper, parallel-safe random numbers are produced via the L'Ecuyer-CMRG method. To disable this check, use 'future.seed = NULL', or set option 'future.rng.onMisuse' to "ignore". 
3: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead. 
